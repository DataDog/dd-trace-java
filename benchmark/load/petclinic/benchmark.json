{
  "name": "load_petclinic",
  "setup": "bash -c \"mkdir -p ${OUTPUT_DIR}/${VARIANT}\"",
  "service": "bash -c \"${CPU_AFFINITY_K6}${UTILS_DIR}/run-k6-load-test.sh http://localhost:8080 ${REPORTS_DIR}/${VARIANT} 'pkill java'\"",
  "run": "bash -c \"${CPU_AFFINITY_APP}java ${JAVA_OPTS} -Xms2G -Xmx2G -jar ${PETCLINIC} &> ${REPORTS_DIR}/${VARIANT}/petclinic.log\"",
  "timeout": 150,
  "iterations": 1,
  "variants": {
    "${NO_AGENT_VARIANT}": {
      "env": {
        "VARIANT": "${NO_AGENT_VARIANT}",
        "JAVA_OPTS": "",
        "CPU_AFFINITY_K6": "taskset -c 24-30 ",
        "CPU_AFFINITY_APP": "taskset -c 31-32 "
      }
    },
    "tracing": {
      "env": {
        "VARIANT": "tracing",
        "JAVA_OPTS": "-javaagent:${TRACER}",
        "CPU_AFFINITY_K6": "taskset -c 24-30 ",
        "CPU_AFFINITY_APP": "taskset -c 33-34 "
      }
    },
    "profiling": {
      "env": {
        "VARIANT": "profiling",
        "JAVA_OPTS": "-javaagent:${TRACER} -Ddd.profiling.enabled=true",
        "CPU_AFFINITY_K6": "taskset -c 24-30 ",
        "CPU_AFFINITY_APP": "taskset -c 35-36 "
      }
    },
    "appsec": {
      "env": {
        "VARIANT": "appsec",
        "JAVA_OPTS": "-javaagent:${TRACER} -Ddd.appsec.enabled=true",
        "CPU_AFFINITY_K6": "taskset -c 24-30 ",
        "CPU_AFFINITY_APP": "taskset -c 37-38 "
      }
    },
    "iast": {
      "env": {
        "VARIANT": "iast",
        "JAVA_OPTS": "-javaagent:${TRACER} -Ddd.iast.enabled=true",
        "CPU_AFFINITY_K6": "taskset -c 24-30 ",
        "CPU_AFFINITY_APP": "taskset -c 39-40 "
      }
    },
    "code_origins": {
      "env": {
        "VARIANT": "code_origins",
        "JAVA_OPTS": "-javaagent:${TRACER} -Ddd.code.origin.for.spans.enabled=true",
        "CPU_AFFINITY_K6": "taskset -c 24-30 ",
        "CPU_AFFINITY_APP": "taskset -c 41-42 "
      }
    }
  }
}
