import com.github.jengelman.gradle.plugins.shadow.tasks.ShadowJar

plugins {
    // Apply the application plugin to add support for building a CLI application in Java.
    id 'application'
    id 'com.gradleup.shadow'
}

tasks.named("shadowJar", ShadowJar) {
    // Define the main class for the application.
    mainClass = 'App'
}

def latestJdk = 17

def latestJdkHome = providers.environmentVariable("JAVA_${latestJdk}_HOME").orNull
if (latestJdkHome != null) {
  tasks.withType(JavaCompile).configureEach {
    options.fork = true
    options.release = latestJdk
    compileJava.options.forkOptions.javaHome = file(latestJdkHome)
  }
}
