ext {
  minJavaVersionForTests = JavaVersion.VERSION_17
}

apply from: "$rootDir/gradle/java.gradle"
apply plugin: "idea"

[compileMain_java17Java, compileTestJava].each {
  it.configure {
    setJavaVersion(it, 17)
    sourceCompatibility = JavaVersion.VERSION_17
    targetCompatibility = JavaVersion.VERSION_17
  }
}

sourceSets {
  main {
    java {
      setSrcDirs(['src/main/java', 'src/main/java17'])
    }
  }
}

dependencies {
  implementation libs.slf4j
  implementation project(':internal-api')
  implementation libs.jnr.unixsocket
}

forbiddenApisMain_java17 {
  failOnMissingClasses = false
}

idea {
  module {
    jdkName = '17'
  }
}
