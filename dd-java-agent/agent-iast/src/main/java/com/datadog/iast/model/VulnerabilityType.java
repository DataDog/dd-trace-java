package com.datadog.iast.model;

import java.util.zip.CRC32;
import javax.annotation.Nonnull;

public enum VulnerabilityType {
  WEAK_CIPHER,
  WEAK_HASH,
  SQL_INJECTION;

  public long calculateHash(@Nonnull final Vulnerability vulnerability) {
    CRC32 crc = new CRC32();
    crc.update(name().getBytes());
    final Location location = vulnerability.getLocation();
    if (location != null) {
      crc.update(location.getLine());
      crc.update(location.getPath().getBytes());
    }
    return crc.getValue();
  }
}
