apply from: "${rootDir}/gradle/java.gradle"

// We have some general logging paths that are hard to test
minimumInstructionCoverage = 0.8
minimumBranchCoverage = 0.8

excludedClassesCoverage += [
  // ControllerFactory gets better tested in actual controller implementations
  'com.datadog.profiling.controller.ControllerFactory',
  // There are some code paths that is impossible/very-very hard to hit
  'com.datadog.profiling.controller.ProfilingSystem.StartRecording',
  'com.datadog.profiling.controller.ProfilingSystem.StopRecording',
  'com.datadog.profiling.jfr.ResolvableJFRType',
  'com.datadog.profiling.mlt.SamplerContext.SamplerContextBuilder', // lombok generated builder
  // TODO: following classes are not complete yet - skip the coverage test until it is final
  'com.datadog.profiling.mlt.JMXSampler',
  'com.datadog.profiling.mlt.ScopeManager',
  'com.datadog.profiling.mlt.ScopeStackCollector'
]

dependencies {
  compile deps.slf4j
  compile project(':dd-trace-api')
  compile project(':internal-api')
  compile project(':dd-trace-core')
  compile group: 'org.eclipse.collections', name: 'eclipse-collections', version: '10.2.0'
  compile group: 'org.eclipse.collections', name: 'eclipse-collections-api', version: '10.2.0'

  testCompile deps.junit5
  testCompile deps.guava
  testCompile deps.mockito
  testCompile deps.jmc
  testCompile group: 'org.awaitility', name: 'awaitility', version: '4.0.1'
  testCompile group: 'nl.jqno.equalsverifier', name: 'equalsverifier', version: '3.3'
}

sourceCompatibility = JavaVersion.VERSION_1_8
targetCompatibility = JavaVersion.VERSION_1_8
