muzzle {
  pass {
    group = 'io.awspring.cloud'
    module = 'spring-cloud-aws-sqs'
    versions = "[3.0.0,)"
    assertInverse = true
  }
}

ext {
  minJavaVersionForTests = JavaVersion.VERSION_17
}


apply from: "$rootDir/gradle/java.gradle"

addTestSuiteForDir('latestDepTest', 'test')

["compileTestGroovy", "compileLatestDepTestGroovy"].each { name ->
  tasks.named(name, GroovyCompile) {
    javaLauncher = getJavaLauncherFor(17)
  }
}

dependencies {
  compileOnly group: 'software.amazon.awssdk', name: 'sqs', version: '2.20.162'
  compileOnly group: 'org.springframework', name: 'spring-messaging', version: '5.3.23'

  testImplementation project(':dd-java-agent:instrumentation:trace-annotation')
  testImplementation project(':dd-java-agent:instrumentation:aws-java:aws-java-sdk-2.2')
  testImplementation project(':dd-java-agent:instrumentation:aws-java:aws-java-sqs-2.0')
  testImplementation project(':dd-java-agent:instrumentation:spring:spring-messaging-4.0')

  testImplementation group: 'org.springframework', name: 'spring-context', version: '6.1.10'
  testImplementation group: 'org.springframework', name: 'spring-test',    version: '6.1.10'
  testImplementation group: 'org.springframework', name: 'spring-core',    version: '6.1.10'
  testImplementation group: 'io.awspring.cloud',  name: 'spring-cloud-aws-sqs', version: '3.1.0'
  testImplementation group: 'software.amazon.awssdk', name: 'sqs',      version: '2.20.162'
  testImplementation group: 'software.amazon.awssdk', name: 'aws-core', version: '2.20.162'
  testImplementation group: 'org.testcontainers', name: 'localstack', version: libs.versions.testcontainers.get()
  testImplementation 'org.slf4j:slf4j-api:2.0.13'
  testImplementation 'ch.qos.logback:logback-classic:1.4.14'
  testImplementation 'ch.qos.logback:logback-core:1.4.14'

  latestDepTestImplementation group: 'org.springframework',      name: 'spring-context', version: '6.+'
  latestDepTestImplementation group: 'org.springframework',      name: 'spring-test',    version: '6.+'
  latestDepTestImplementation group: 'org.springframework',      name: 'spring-core',    version: '6.+'
  latestDepTestImplementation group: 'software.amazon.awssdk',   name: 'sqs',            version: '2.+'
  latestDepTestImplementation group: 'software.amazon.awssdk',   name: 'aws-core',       version: '2.+'
}
