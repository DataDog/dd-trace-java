muzzle {
  pass {
    group = 'org.jboss.modules'
    module = 'jboss-modules'
    versions = '[1.3,)'
  }
}

apply from: "$rootDir/gradle/java.gradle"

addTestSuite("latestDepTest")

dependencies {
  compileOnly group: 'org.jboss.modules', name: 'jboss-modules', version: '1.3.0.Final'
  testImplementation group: 'org.jboss.modules', name: 'jboss-modules', version: '1.3.0.Final'
  latestDepTestImplementation group: 'org.jboss.modules', name: 'jboss-modules', version: '+'
}

// jboss-modules requires Java 11: https://github.com/jboss-modules/jboss-modules/blob/2.x/README.md
tasks.named("latestDepTest", Test) {
  onlyIf { javaVersion.isJava11Compatible() }
}

tasks.withType(Test).configureEach {
  if (it.javaVersion.isJava9Compatible()) {
    jvmArgs +='--add-exports=java.xml/com.sun.org.apache.xerces.internal.jaxp=ALL-UNNAMED'
  }
}
