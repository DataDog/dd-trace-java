ext {
  latestDepTestMinJavaVersionForTests = JavaVersion.VERSION_21
  latestDepForkedTestMinJavaVersionForTests = JavaVersion.VERSION_21
}
muzzle {
  pass {
    group = 'com.aerospike'
    module = 'aerospike-client'
    versions = "[4,8)"
    skipVersions += "4.4.19" // bad release
  }
}

apply from: "$rootDir/gradle/java.gradle"


addTestSuiteForDir("latestDepTest", "test")
addTestSuiteForDir("latest7DepTest", "test")
addTestSuiteExtendingForDir("latestDepForkedTest", "latestDepTest", "test")
addTestSuiteExtendingForDir("latest7DepForkedTest", "latest7DepTest", "test")


dependencies {
  compileOnly instrumentedLibs.aerospike.client.v4

  testImplementation instrumentedLibs.aerospike.client.v4
  testImplementation libs.testcontainers

  latest7DepTestImplementation instrumentedLibs.aerospike.client.latest.v7x
  latestDepTestImplementation instrumentedLibs.aerospike.client.latest
}

tasks.withType(Test).configureEach {
  usesService(testcontainersLimit)
}
