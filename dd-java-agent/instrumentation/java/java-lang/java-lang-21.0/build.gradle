plugins {
  id 'idea'
}

apply from: "$rootDir/gradle/java.gradle"

testJvmConstraints {
  minJavaVersion = JavaVersion.VERSION_21
}

muzzle {
  pass {
    coreJdk('21')
  }
}

idea {
  module {
    jdkName = '21'
  }
}

// Set test compile task to use JDK 21 to use the virtual threads API
tasks.named("compileTestJava", JavaCompile) {
  configureCompiler(it, 21)
}

dependencies {
  testImplementation project(':dd-java-agent:instrumentation:datadog:tracing:trace-annotation')
}

// Use latest logback for Java 21+ tests with better virtual thread support.
configurations.named("testRuntimeClasspath") {
  resolutionStrategy {
    force libs.logback.classic.latest
  }
}

