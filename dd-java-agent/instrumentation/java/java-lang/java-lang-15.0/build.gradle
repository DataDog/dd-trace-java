plugins {
  id 'idea'
}

apply from: "$rootDir/gradle/java.gradle"
apply plugin: 'call-site-instrumentation'

testJvmConstraints {
  minJavaVersion = JavaVersion.VERSION_15
}

muzzle {
  pass {
    coreJdk()
  }
}

idea {
  module {
    jdkName = '17'
  }
}

csi {
  javaVersion = JavaLanguageVersion.of(17)
}

addTestSuiteForDir('latestDepTest', 'test')

dependencies {
  testImplementation(libs.javaparser)
  testRuntimeOnly project(':dd-java-agent:instrumentation:iast-instrumenter')
}

tasks.withType(AbstractCompile).configureEach {
  switch (it.name) {
    case 'compileCsiJava':
      configureCompiler(it, 17, JavaVersion.VERSION_1_8)
      break
    default:
      configureCompiler(it, 17, JavaVersion.VERSION_15)
  }
}
